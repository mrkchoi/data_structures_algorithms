

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <style>
    body {
      font-family: "Helvetica Neue", Helvetica, sans-serif;
    }
  
    .item {
      display: flex;
      align-items: center;
      border: 1px solid lightgrey;
      padding: .4rem;
      margin: .4rem;
    }
  
    .item img {
      max-width: 50px;
      border-radius: 50%;
      margin-right: 1rem;
    }
  
    li {
      list-style: none;
    }
  </style>
  
  <h1>Organisation Chart</h1>
  
  
  <main class="employees">
    <ul></ul>
  </main>
  
  <script>
    const data = [{
      id: 20,
      name: 'Miyah Myles',
      image: 'https://randomuser.me/api/portraits/women/44.jpg',
      reportees: [62]
    }, {
      id: 31,
      name: 'Zachary Levi',
      image: 'https://randomuser.me/api/portraits/men/97.jpg',
      reportees: [92]
    }, {
      id: 62,
      name: 'Britney Cooper',
      image: 'https://randomuser.me/api/portraits/women/68.jpg',
      reportees: null
    }, {
      id: 92,
      name: 'Lilja Peltola',
      image: 'https://randomuser.me/api/portraits/women/17.jpg',
      reportees: null
    }, {
      id: 23,
      name: 'Leo Gill',
      image: 'https://randomuser.me/api/portraits/men/32.jpg',
      reportees: [20, 31],
    }];


    // iterate through data array => convert to map (k/v pairs)
    // we have access to root node (id:23)
    // helper function to generate DOM element
    // use recursion/iteration to call all child elements until !reportees

    const map = {};

    data.forEach(datum => {
      map[datum.id] = datum
    });

    // root node === id: 23 => map[23]

    function renderEmployees(emp, ul) {
      let li = document.createElement('li');
      let div = document.createElement('div');
      div.classList.add('item');
      let img = document.createElement('img');
      img.setAttribute('src', emp.image);
      let text = document.createElement('p');
      text.textContent = emp.name;
      div.appendChild(img);
      div.appendChild(text);
      li.appendChild(div);
      ul.appendChild(li);
      if (emp.reportees) {
        let childUl = document.createElement('ul');
        li.appendChild(childUl);
        emp.reportees.forEach(reporteeId => {
          renderEmployees(map[reporteeId], childUl);
        });
      }
    }

    renderEmployees(map[23], document.querySelector('.employees ul'));


  </script>
</body>
</html>